{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Ilyas\\\\Desktop\\\\React\\\\apeiron\\\\my-app\\\\src\\\\component\\\\profile\\\\ProfilePostsFeatures\\\\ProfileWritePost\\\\ProfileWritePost.jsx\";\nimport React from \"react\";\nimport c from './ProfileWritePost.module.css';\nimport axios from 'axios';\nimport GetCookie from \"../../../../hook/getCookie\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ProfileWritePost = props => {\n  // console.log(props);\n\n  let newPostElement = /*#__PURE__*/React.createRef();\n  var formData = new FormData();\n  var imagefile = document.querySelector('#file');\n  const Cookie = JSON.parse(GetCookie('usrin'));\n  const CookieToken = Cookie['token'];\n  async function SendMessageToServer(path) {\n    const json = JSON.stringify({\n      \"message\": props.props.newPostText,\n      \"path\": path\n    });\n    await axios.post('http://apeiron-test.kz/posts/postUploadText', json, {\n      headers: {\n        Authorization: 'Bearer ' + CookieToken\n      }\n    }).then(response => {\n      // console.log(response.data);\n      // console.log(path);\n    });\n    onAddPost();\n    GetPosts();\n    // window.location.reload();\n  }\n\n  async function SendImgOnServer() {\n    formData.append(\"PostImage\", imagefile.files[0]);\n    axios.post('http://apeiron-test.kz/posts/postUploadImg', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data',\n        Authorization: 'Bearer ' + CookieToken\n      }\n    }).then(response => {\n      //console.log(response);\n      SendMessageToServer(response.data.path);\n      // \n      // onAddPost();\n    });\n  }\n\n  async function GetPosts() {\n    await axios.get(`http://apeiron-test.kz/posts`, {\n      headers: {\n        Authorization: 'Bearer ' + JSON.parse(GetCookie('usrin'))['token']\n      }\n    }).then(response => {\n      // console.log(response);\n      props.props.SetPosts(response.data);\n      // console.log(response);\n      console.log(props);\n      //console.log(this.props);\n      //let PostsData = this.props.Posts[0].map(post => <ProfilePost key={post.id} ProfileName={props.ProfileLogin} data={post.data} messages={post.message} like={post.countOfLikes} commetsCount={post.countOfComments}  repostsCount={post.repostsCount} postImage={post.imagePath}/>);\n      // Posts = response.data;\n    });\n  }\n\n  let onAddPost = () => {\n    props.props.addPost();\n  };\n  let onPostChange = () => {\n    let text = newPostElement.current.value;\n    props.props.updataNewPostText(text);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: c.WritePostBlock,\n    children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n      ref: newPostElement,\n      onChange: onPostChange,\n      value: props.props.newPostText\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n      type: \"file\",\n      name: \"fiel\",\n      id: \"file\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      onClick: SendImgOnServer,\n      children: \"\\u041E\\u043F\\u0443\\u0431\\u043B\\u0438\\u043A\\u043E\\u0432\\u0430\\u0442\\u044C\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n};\n_c = ProfileWritePost;\nexport default ProfileWritePost;\nvar _c;\n$RefreshReg$(_c, \"ProfileWritePost\");","map":{"version":3,"names":["React","c","axios","GetCookie","ProfileWritePost","props","newPostElement","createRef","formData","FormData","imagefile","document","querySelector","Cookie","JSON","parse","CookieToken","SendMessageToServer","path","json","stringify","newPostText","post","headers","Authorization","then","response","onAddPost","GetPosts","SendImgOnServer","append","files","data","get","SetPosts","console","log","addPost","onPostChange","text","current","value","updataNewPostText","WritePostBlock"],"sources":["C:/Users/Ilyas/Desktop/React/apeiron/my-app/src/component/profile/ProfilePostsFeatures/ProfileWritePost/ProfileWritePost.jsx"],"sourcesContent":["import React from \"react\";\r\nimport c from './ProfileWritePost.module.css'\r\nimport axios from 'axios';\r\nimport GetCookie from \"../../../../hook/getCookie\";\r\n\r\nconst ProfileWritePost = (props) => {\r\n  // console.log(props);\r\n\r\n    let newPostElement = React.createRef();\r\n    var formData = new FormData();\r\n    var imagefile = document.querySelector('#file');\r\n    const Cookie = JSON.parse(GetCookie('usrin'));\r\n    const CookieToken = Cookie['token'];\r\n\r\n    async function SendMessageToServer(path){\r\n      const json = JSON.stringify({ \r\n          \"message\": props.props.newPostText,\r\n          \"path\": path\r\n       });\r\n      await  axios.post('http://apeiron-test.kz/posts/postUploadText', json,{\r\n        headers:{\r\n          Authorization: 'Bearer ' + CookieToken\r\n        }\r\n      }).then(response => {\r\n          // console.log(response.data);\r\n          // console.log(path);\r\n          })\r\n          onAddPost();\r\n          GetPosts();\r\n          // window.location.reload();\r\n  }\r\n\r\n    async function SendImgOnServer(){\r\n      formData.append(\"PostImage\", imagefile.files[0]);\r\n      axios.post('http://apeiron-test.kz/posts/postUploadImg', formData, {\r\n          headers: {\r\n          'Content-Type': 'multipart/form-data',\r\n          Authorization: 'Bearer ' + CookieToken\r\n          }\r\n      }).then(response => {\r\n          //console.log(response);\r\n          SendMessageToServer(response.data.path);\r\n          // \r\n          // onAddPost();\r\n       })\r\n\r\n    }\r\n\r\n    async function GetPosts(){\r\n      await axios.get(`http://apeiron-test.kz/posts`,{\r\n        headers:{\r\n          Authorization: 'Bearer ' + JSON.parse(GetCookie('usrin'))['token']\r\n        }\r\n      })\r\n      .then(response =>{\r\n        // console.log(response);\r\n        props.props.SetPosts(response.data);\r\n        // console.log(response);\r\n        console.log(props);\r\n        //console.log(this.props);\r\n        //let PostsData = this.props.Posts[0].map(post => <ProfilePost key={post.id} ProfileName={props.ProfileLogin} data={post.data} messages={post.message} like={post.countOfLikes} commetsCount={post.countOfComments}  repostsCount={post.repostsCount} postImage={post.imagePath}/>);\r\n        // Posts = response.data;\r\n      })\r\n    }\r\n  \r\n    let onAddPost = () => {\r\n      props.props.addPost();\r\n    }\r\n  \r\n    let onPostChange = () =>{\r\n      let text = newPostElement.current.value;\r\n      props.props.updataNewPostText(text);\r\n  \r\n    }\r\n    return(\r\n        <div className={c.WritePostBlock}>\r\n            <textarea ref={newPostElement} onChange={onPostChange} \r\n                    value={props.props.newPostText}>\r\n            </textarea>\r\n            <input type=\"file\" name=\"fiel\" id=\"file\"/>\r\n            <button onClick={SendImgOnServer}>Опубликовать</button>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ProfileWritePost;"],"mappings":"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"},"metadata":{},"sourceType":"module"}